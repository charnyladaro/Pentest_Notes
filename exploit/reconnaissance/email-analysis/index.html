<!DOCTYPE html>
<html lang="en" class="m-0 p-0 w-screen min-h-screen bg-navy-dark">
  <!-- Mirrored from exploit-notes.hdks.org/exploit/reconnaissance/email-analysis/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 15 Apr 2024 05:42:41 GMT -->
  <!-- Added by HTTrack --><meta
    http-equiv="content-type"
    content="text/html;charset=UTF-8"
  /><!-- /Added by HTTrack -->
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Email Analysis | Pentest Notes</title>
    <meta
      name="description"
      content="Detecting malware from messages, check if they are phishing."
    />

    <link rel="icon" type="image/x-icon" href="../../../img/favicon.png" />
    <link rel="stylesheet" href="../../../pagefind/pagefind-ui.css" />
    <link rel="stylesheet" href="../../../styles.css" />
    <link rel="stylesheet" href="../../../css/carbonads.css" />

    <script type="text/javascript" src="../../../js/exploit.js"></script>

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@hideckies" />
    <meta name="twitter:creator" content="@hideckies" />
    <meta
      property="og:url"
      content="https://exploit-notes.hdks.org/exploit/reconnaissance/email-analysis/"
    />
    <meta property="og:title" content="Email Analysis | Exploit Notes" />
    <meta
      property="og:description"
      content="Detecting malware from messages, check if they are phishing."
    />
    <meta
      property="og:image"
      content="https://exploit-notes.hdks.org/img/screenshot.png"
    />

    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-RR6XYHYTQ9");
    </script>
    <script
      type="text/javascript"
      src="../../../pagefind/pagefind-ui.js"
    ></script>
    <script type="text/javascript">
      window.addEventListener("DOMContentLoaded", () => {
        new PagefindUI({
          element: "#search",
          showImages: false,
          excerptLength: 0,
          showEmptyFilters: true,
          showSubResults: false,
          resetStyles: true,
          bundlePath: "/pagefind/",
          baseUrl: "/",
        });
      });
    </script>
    <link rel="stylesheet" href="../../../codecopy/codecopy.css" />
    <script type="text/javascript" src="../../../codecopy/codecopy.js"></script>
  </head>

  <body class="relative w-screen min-h-screen text-basic text-white text-sm">
    <header
      class="sticky top-0 left-0 w-full z-20 bg-gradient-to-r from-green-dark p-2"
    >
      <div
        class="md:mx-auto w-full md:w-2/3 h-full flex justify-around items-center"
      >
        <div
          class="w-full md:w-2/3 lg:w-1/2 h-full flex flex-col md:flex-row items-center md:gap-x-3 gap-y-3 md:gap-y-0"
        >
          <a href="../../../index.html">
            <span class="text-sm text-white font-bold"> Pentest Notes </span>
          </a>

          <div id="search" class=""></div>
        </div>

        <div
          class="hidden sm:flex w-full h-full items-center justify-center gap-x-3"
        >
          <a
            href="https://github.com/hideckies/exploit-notes"
            target="_blank"
            rel="noopener noreferrer"
            alt="GitHub"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewbox="0 0 24 24"
              class="w-7 h-7 fill-white"
            >
              <path
                d="
                            M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207
                            11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729
                            1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304
                            3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381
                            1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399
                            3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242
                            2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823
                            1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
              ></path>
            </svg>
          </a>

          <a
            href="https://twitter.com/hideckies"
            target="_blank"
            rel="noopener noreferrer"
            alt="Twitter"
          >
            <img
              src="../../../img/x.png"
              alt="Twitter"
              width="22"
              height="22"
              class="w-6 h-6"
            />
          </a>

          <a
            href="https://ko-fi.com/hideckies"
            target="_blank"
            rel="noopener noreferrer"
            alt="Ko-fi"
          >
            <img
              src="../../../img/kofi_cropped.png"
              alt="Ko-fi"
              width="22"
              height="22"
              class="w-10 h-10"
            />
          </a>
        </div>
      </div>
    </header>

    <div
      class="hamburger fixed top-3 right-2 z-40 block md:hidden cursor-pointer"
    >
      <div class="lines">
        <span class="line bg-white"></span>
        <span class="line bg-white"></span>
        <span class="line bg-white"></span>
      </div>
      <div
        class="line-cross hidden md:hidden text-[22px] text-white leading-none"
      ></div>
    </div>

    <div
      id="search_bg"
      class="fixed top-0 left-0 w-screen z-10 h-screen hidden bg-black opacity-50"
    ></div>

    <style>
      .hamburger .lines span.line {
        display: block;
        width: 20px;
        height: 3px;
        margin-bottom: 5px;
      }

      .hamburger .line-cross:before {
        content: "\2716";
      }
    </style>

    <script>
      window.addEventListener("DOMContentLoaded", () => {
        //Display the black filter when searching
        const searchBgElem = document.getElementById("search_bg");
        const drawerElem = document.querySelector(".pagefind-ui__drawer");
        const inputElem = document.querySelector(".pagefind-ui__search-input");

        if (searchBgElem) {
          searchBgElem.addEventListener("click", () => {
            searchBgElem.classList.add("hidden");
            drawerElem.style.visibility = "hidden";
            drawerElem.style.opacity = 0;
          });
        }

        inputElem.addEventListener("focus", () => {
          if (searchBgElem) {
            searchBgElem.classList.remove("hidden");
            drawerElem.style.visibility = "visible";
            drawerElem.style.opacity = 1;
          }
        });
      });
    </script>
    <nav class="nav-links hidden">
      <div class="w-full flex flex-col gap-y-4">
        <div>
          <h3 class="my-4 text-base text-white opacity-60">SOCIAL</h3>
          <div class="w-full flex flex-col gap-y-1">
            <a
              href="https://github.com/hideckies/exploit-notes"
              target="_blank"
              rel="noopener noreferrer"
              class="text-lg"
            >
              GitHub
            </a>
            <a
              href="https://twitter.com/hideckies"
              target="_blank"
              rel="noopener noreferrer"
              class="text-lg"
            >
              Twitter
            </a>
            <a
              href="https://ko-fi.com/hideckies"
              target="_blank"
              rel="noopener noreferrer"
              class="text-lg"
            >
              Support Me
            </a>
          </div>
        </div>
        <div>
          <h3 class="my-4 text-base text-white opacity-60">PAGES</h3>
          <div class="w-full flex flex-col gap-y-1">
            <a href="../../../disclaimer/index.html" class="text-lg">
              Disclaimer
            </a>
          </div>
          <div class="w-full flex flex-col gap-y-1">
            <a href="../../../privacy-policy/index.html" class="text-lg">
              Privacy Policy
            </a>
          </div>
        </div>
        <div>
          <h3 class="my-4 text-base text-white opacity-60">OTHER TOOLS</h3>
          <div class="w-full flex flex-col gap-y-1">
            <a
              href="https://security-links.hdks.org/"
              target="_blank"
              rel="noopener noreferrer"
              class="text-lg"
            >
              Security Links
            </a>
            <a
              href="https://github.com/hideckies/hermit"
              target="_blank"
              rel="noopener noreferrer"
              class="text-lg"
            >
              Hermit C2
            </a>
            <a
              href="https://github.com/hideckies/fuzzagotchi"
              target="_blank"
              rel="noopener noreferrer"
              class="text-lg"
            >
              Fuzzagotchi
            </a>
          </div>
        </div>
      </div>
    </nav>

    <style>
      /* Navigation for mobile */
      .nav-links-hamburger {
        position: fixed;
        top: 0;
        right: 0;
        z-index: 30;
        width: 100vw;
        height: 100vh;
        min-height: 100vh;
        background-color: var(--color-slate-dark);
        padding: 60px 32px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: flex-start;
        gap: 32px 0px;
        color: var(--color-khaki);
      }
    </style>
    <main class="w-full h-full">
      <div
        class="block sm:grid grid-cols-[320px_minmax(400px,_1fr)_280px] py-2"
      >
        <div
          id="exploit-leftside-inner"
          class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3"
        >
          <div class="w-full">
            <div id="exploit-related">
              <h4
                class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80"
              >
                OSINT
              </h4>

              <div class="my-3">
                <a
                  href="../osint/imint-and-geoint/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  IMINT (Image Intelligence) and GEOINT (Geospatial
                  Intelligence)
                </a>
              </div>

              <div class="my-3">
                <a
                  href="../osint/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  OSINT (Open Source Intelligence)
                </a>
              </div>

              <h4
                class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80"
              >
                Search Technique
              </h4>

              <div class="my-3">
                <a
                  href="../search-technique/github-dorks/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  GitHub Dorks
                </a>
              </div>

              <div class="my-3">
                <a
                  href="../search-technique/google-dorks/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Google Dorks
                </a>
              </div>

              <div class="my-3">
                <a
                  href="../search-technique/shodan-dorks/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Shodan Dorks
                </a>
              </div>

              <h4
                class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80"
              >
                Network
              </h4>

              <div class="my-3">
                <a
                  href="../network/port-scan/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Port Scan
                </a>
              </div>

              <h4
                class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80"
              >
                Subdomain
              </h4>

              <div class="my-3">
                <a
                  href="../subdomain/subdomain-discovery/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Subdomain Discovery
                </a>
              </div>

              <div class="my-3">
                <a
                  href="../subdomain/subdomain-takeover/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Subdomain Takeover
                </a>
              </div>

              <h4
                class="mb-4 border-b-2 border-slate-light text-base text-white opacity-80"
              >
                Others
              </h4>

              <div class="my-3">
                <span id="scroll-target" class="text-sm text-white">
                  Email Analysis
                </span>
              </div>

              <div class="my-3">
                <a
                  href="../find-leaked-api-keys/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Find Leaked API Keys
                </a>
              </div>

              <div class="my-3">
                <a
                  href="../person-investigation/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Person Investigation
                </a>
              </div>

              <div class="my-3">
                <a
                  href="../index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Reconnaissance
                </a>
              </div>

              <div class="my-3">
                <a
                  href="../social-engineering/index.html"
                  class="text-sm text-green-light hover:brightness-200"
                >
                  Social Engineering
                </a>
              </div>
            </div>
          </div>
        </div>

        <div
          id="exploit-center-inner"
          class="w-full h-screen overflow-y-auto px-2 md:px-6 py-3"
          data-pagefind-body=""
        >
          <article>
            <div class="w-full p-4">
              <h1 id="exploit-title" class="text-4xl font-bold">
                Email Analysis
              </h1>
              <p class="my-3 text-base">Last modified: 2023-10-14</p>

              <div class="my-3 flex flex-wrap items-end space-x-2 space-y-2">
                <span
                  class="bg-green-dark rounded-md text-base px-3 py-1 text-pink-dark"
                  >Reconnaissance</span
                >
              </div>
            </div>

            <hr class="border-1 border-white opacity-40" />

            <p class="px-2 py-4 text-base">
              Detecting malware from messages, check if they are phishing.
            </p>

            <div id="exploit-content" class="px-2 py-4 text-base">
              <h2 id="osint" tabindex="-1">
                <a href="#osint" class="header-anchor">OSINT</a>
              </h2>
              <ul>
                <li>
                  <p>
                    <strong
                      ><a href="https://labs.inquest.net/"
                        >InQuest Labs</a
                      ></strong
                    >
                  </p>
                </li>
                <li>
                  <p>
                    <strong
                      ><a href="https://mha.azurewebsites.net/"
                        >Message Header Analyzer</a
                      ></strong
                    >
                  </p>
                  <p>
                    Analyses message header of email. It helps to check the
                    phishing emails.
                  </p>
                </li>
                <li>
                  <p>
                    <strong
                      ><a href="https://www.phishtool.com/"
                        >PhishTool</a
                      ></strong
                    >
                  </p>
                  <p>
                    Combines threat intelligence, OSINT, email metadata and
                    battle tested auto-analysis pathways into one powerful
                    phishing response platform.
                  </p>
                </li>
                <li>
                  <p>
                    <strong
                      ><a href="https://emailrep.io/"
                        >Simple Email Reputation</a
                      ></strong
                    >
                  </p>
                  <p>
                    Paste the sender’s email address to check if the address is
                    suspicious.
                  </p>
                </li>
                <li>
                  <p>
                    <strong
                      ><a href="https://www.virustotal.com/gui/"
                        >VirusTotal</a
                      ></strong
                    >
                  </p>
                </li>
              </ul>
              <br />
              <h2 id="email-source-analysis" tabindex="-1">
                <a href="#email-source-analysis" class="header-anchor"
                  >Email Source Analysis</a
                >
              </h2>
              <p>
                We can see the email source in each provider or execute the
                following commands.
              </p>
              <pre
                class="codecopy_pre codecopy_pre_0"
              ><code class="language-sh hljs language-bash">open example.xml
strings example.eml
</code><button class="codecopy_copy" data-codecopy="0">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
              <p>
                Check the following headers to distinguish whether it is
                spoofed.
              </p>
              <h3 id="authentication-results" tabindex="-1">
                <a href="#authentication-results" class="header-anchor"
                  >Authentication-Results</a
                >
              </h3>
              <p>
                Each value in
                <strong
                  ><code>dkim</code>, <code>spf</code>,
                  <code>dmarc</code></strong
                >
                should be <strong><code>pass</code></strong
                >. If not, the email may be spoofed.
              </p>
              <h3 id="received" tabindex="-1">
                <a href="#received" class="header-anchor">Received</a>
              </h3>
              <p>It should match the sender’s email address.</p>
              <h3 id="received-spf" tabindex="-1">
                <a href="#received-spf" class="header-anchor">Received-SPF</a>
              </h3>
              <p>
                Its value should be <strong><code>pass</code></strong
                >. If its value is
                <strong
                  ><code>faile</code>, <code>softfail</code>,
                  <code>neutral</code> or <code>none</code></strong
                >, the email may be spoofed.
              </p>
              <h3 id="others" tabindex="-1">
                <a href="#others" class="header-anchor">Others</a>
              </h3>
              <p>
                Besides, check if the sender displayed name or address match
                <strong
                  ><code>From</code>, <code>Reply-To</code>,
                  <code>Return-Path</code></strong
                >
                in headers. However, these header values can be modified by
                attackers so it could not be relied perfectly.
              </p>
              <br />
              <h2
                id="check-spf%2C-dkim%2C-dmarc-records-of-domain"
                tabindex="-1"
              >
                <a
                  href="#check-spf%2C-dkim%2C-dmarc-records-of-domain"
                  class="header-anchor"
                  >Check SPF, DKIM, DMARC Records of Domain</a
                >
              </h2>
              <p>
                To confirm if these records exist in a domain, use
                <code>dig</code> command. If not exist, the domain may be
                spoofed, or may be categorized spam by some email providers.
              </p>
              <pre
                class="codecopy_pre codecopy_pre_1"
              ><code class="language-bash hljs">dig example.com txt
</code><button class="codecopy_copy" data-codecopy="1">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
              <p>
                Also we can check that using online tools such as
                <a href="https://mxtoolbox.com/">MxToolbox</a>.
              </p>
              <h3 id="spf-record" tabindex="-1">
                <a href="#spf-record" class="header-anchor">SPF Record</a>
              </h3>
              <pre
                class="codecopy_pre codecopy_pre_2"
              ><code class="language-bash hljs">dig example.com txt

<span class="hljs-comment"># output example:</span>
example.com.  IN  TXT  <span class="hljs-string">"v=spf1 include:spf.example.com -all"</span>
example.com.  IN  TXT  <span class="hljs-string">"v=spf1 +ip4:10.0.0.1/24 -all"</span>
example.com.  IN  TXT  <span class="hljs-string">"v=spf1 a:mail.example.com -all"</span>
example.com.  IN  TXT  <span class="hljs-string">"v=spf1 -all"</span>
example.com.  IN  TXT  <span class="hljs-string">"v=spf1 mx -all"</span>
</code><button class="codecopy_copy" data-codecopy="2">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
              <h3 id="check-dkim-record" tabindex="-1">
                <a href="#check-dkim-record" class="header-anchor"
                  >Check DKIM Record</a
                >
              </h3>
              <pre
                class="codecopy_pre codecopy_pre_3"
              ><code class="language-bash hljs">dig selector._domainkey.example.com txt

<span class="hljs-comment"># output examples:</span>
selector._domainkey.example.com  IN  TXT  k=rsa;p=J8eTBu224i086iK
selector._domainkey.example.com  IN  TXT  <span class="hljs-string">"selector._domainkey.example.com. 0  IN  TXT  "</span>v=DKIM1; p=ABC...123;<span class="hljs-string">""</span>
</code><button class="codecopy_copy" data-codecopy="3">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
              <p>
                To check <code>DKIM</code> record, we need to specify the DKIM
                selector. It can be found in <code>s=</code> header value of
                dkim section in email header such as Authentication-Results. For
                example,
              </p>
              <pre
                class="codecopy_pre codecopy_pre_4"
              ><code class="language-bash hljs">Authentication-Results: mx.google.com;
  dkim=pass header.i=@example.com header.s=s1234 header.b=ABCDEF123
</code><button class="codecopy_copy" data-codecopy="4">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
              <p>
                In this case, we execute
                <code
                  >dig [s1234.example.com](http://s1234.example.com) txt</code
                >
                .
              </p>
              <h3 id="check-dmarc-record" tabindex="-1">
                <a href="#check-dmarc-record" class="header-anchor"
                  >Check DMARC Record</a
                >
              </h3>
              <pre
                class="codecopy_pre codecopy_pre_5"
              ><code class="language-bash hljs">dig _dmarc.example.com txt

<span class="hljs-comment"># output examples:</span>
_dmarc.example.com.  IN  TXT  <span class="hljs-string">"v=DMARC1; p=reject; rua=mailto:mailauth-reports@example.com"</span>
</code><button class="codecopy_copy" data-codecopy="5">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
              <br />
              <h2 id="be-careful-of-fake-reply-message" tabindex="-1">
                <a
                  href="#be-careful-of-fake-reply-message"
                  class="header-anchor"
                  >Be Careful of Fake Reply Message</a
                >
              </h2>
              <p>
                If the email contains
                <strong><code>RE:</code></strong> (Regarding) which means
                replying your message, we need to check that it’s a really reply
                message. Attacker may impersonate reply message that victim
                communicated in the past.
              </p>
              <br />
              <h2 id="malware-detection-in-attached-files" tabindex="-1">
                <a
                  href="#malware-detection-in-attached-files"
                  class="header-anchor"
                  >Malware Detection in Attached Files</a
                >
              </h2>
              <p>
                If you got email in which attached
                <strong><code>suspicious</code></strong> files, you need to
                investigate them.
              </p>
              <ol>
                <li>
                  <p><strong>View the Message Source</strong></p>
                </li>
                <li>
                  <p><strong>Copy the Attached File's Base64</strong></p>
                </li>
                <li>
                  <p><strong>Change Base64 to SHA256</strong></p>
                  <pre
                    class="codecopy_pre codecopy_pre_6"
                  ><code class="language-sh hljs language-bash"><span class="hljs-built_in">sha256sum</span> attached_file.doc
<span class="hljs-comment"># or</span>
<span class="hljs-built_in">echo</span> -n <span class="hljs-string">'abcde..=='</span> &gt; hash.txt
<span class="hljs-built_in">sha256sum</span> hash.txt
</code><button class="codecopy_copy" data-codecopy="6">
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="2.0" stroke="currentColor" class="w-6 h-6">
    <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"></path>
</svg><span class="codecopy_result">Copied!</span></button></pre>
                  <p>Or there are some useful tools:</p>
                  <ul>
                    <li>
                      <strong
                        ><a href="https://gchq.github.io/CyberChef/"
                          >CyberChef</a
                        ></strong
                      >
                      is useful to change the cipher.
                    </li>
                  </ul>
                </li>
                <li>
                  <p><strong>Investigate the Hash</strong></p>
                  <p>There are some useful tools:</p>
                  <ul>
                    <li>
                      <p>
                        <strong
                          ><a href="https://labs.inquest.net/"
                            >InQuest Labs</a
                          ></strong
                        >
                      </p>
                    </li>
                    <li>
                      <p>
                        <strong
                          ><a
                            href="https://www.talosintelligence.com/talos_file_reputation"
                            >Talos File Reputation</a
                          ></strong
                        >
                      </p>
                    </li>
                    <li>
                      <p>
                        <strong
                          ><a href="https://www.virustotal.com/gui/home/upload"
                            >VirusTotal</a
                          ></strong
                        >
                      </p>
                    </li>
                  </ul>
                </li>
              </ol>
            </div>

            <div class="my-6 p-4">
              <h2 class="text-3xl font-bold border-b-[1px] border-pink-dark">
                References
              </h2>
              <ul class="my-6 ml-4 list-disc break-all">
                <li class="my-2">
                  <a
                    href="https://www.crowdstrike.com/cybersecurity-101/spoofing-attacks/email-spoofing/"
                    class="text-base text-green-light hover:brightness-200"
                  >
                    https://www.crowdstrike.com/cybersecurity-101/spoofing-attacks/email-spoofing/
                  </a>
                </li>
              </ul>
            </div>
          </article>
        </div>

        <div
          id="exploit-rightside-inner"
          class="hidden sm:block w-full h-screen overflow-y-auto px-4 py-3"
        >
          <div class="flex flex-col gap-y-4">
            <div>
              <h5
                class="mb-4 border-b-2 border-slate-light text-sm text-white opacity-60"
              >
                ON THIS PAGE
              </h5>
              <div class="toc my-4 flex flex-col gap-y-2">
                <a href="#osint" class="text-sm break-words">OSINT</a
                ><a href="#email-source-analysis" class="text-sm break-words"
                  >Email Source Analysis</a
                ><a
                  href="#check-spf%2C-dkim%2C-dmarc-records-of-domain"
                  class="text-sm break-words"
                  >Check SPF, DKIM, DMARC Records of Domain</a
                ><a
                  href="#be-careful-of-fake-reply-message"
                  class="text-sm break-words"
                  >Be Careful of Fake Reply Message</a
                ><a
                  href="#malware-detection-in-attached-files"
                  class="text-sm break-words"
                  >Malware Detection in Attached Files</a
                >
              </div>
            </div>
            <div>
              <script
                async=""
                type="text/javascript"
                src="../../../../cdn.carbonads.com/carbonebf3.js?serve=CWYDE53L&amp;placement=exploit-noteshdksorg"
                id="_carbonads_js"
              ></script>
            </div>
          </div>
        </div>
      </div>
    </main>
    <footer class="mt-12 w-full p-8 bg-navy-light">
      <div
        class="md:mx-auto w-full md:w-2/3 flex flex-col md:flex-row md:items-start gap-y-3 md:gap-y-0 text-base"
      >
        <div class="w-full flex flex-col gap-y-2">
          <h3 class="text-sm opacity-60">SOCIALS</h3>
          <div
            class="w-full flex flex-col lg:flex-row items-start lg:items-center gap-y-2 lg:gap-3"
          >
            <a
              href="https://github.com/hideckies/exploit-notes"
              target="_blank"
              rel="noopener noreferrer"
            >
              GitHub
            </a>
            <a
              href="https://twitter.com/hideckies"
              target="_blank"
              rel="noopener noreferrer"
            >
              Twitter
            </a>
            <a
              href="https://ko-fi.com/hideckies"
              target="_blank"
              rel="noopener noreferrer"
            >
              Support Me
            </a>
          </div>
        </div>

        <div class="w-full flex flex-col gap-y-2">
          <h3 class="text-sm opacity-60">PAGES</h3>
          <div
            class="w-full flex flex-col lg:flex-row items-start lg:items-center gap-y-2 lg:gap-3"
          >
            <a href="../../../disclaimer/index.html">Disclaimer</a>
            <a href="../../../privacy-policy/index.html">Privacy Policy</a>
          </div>
        </div>

        <div class="w-full flex flex-col gap-y-2">
          <h3 class="text-sm opacity-60">OTHER TOOLS</h3>
          <div
            class="w-full flex flex-col lg:flex-row lg:flex-wrap items-start lg:items-center gap-y-2 lg:gap-3"
          >
            <a
              href="https://security-links.hdks.org/"
              target="_blank"
              rel="noopener noreferrer"
            >
              Security Links
            </a>
            <a
              href="https://github.com/hideckies/hermit"
              target="_blank"
              rel="noopener noreferrer"
            >
              Hermit C2
            </a>
            <a
              href="https://github.com/hideckies/fuzzagotchi"
              target="_blank"
              rel="noopener noreferrer"
            >
              Fuzzagotchi
            </a>
          </div>
        </div>
      </div>
    </footer>

    <script type="text/javascript" src="../../../js/hamburger.js"></script>
  </body>
  <!-- Mirrored from exploit-notes.hdks.org/exploit/reconnaissance/email-analysis/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 15 Apr 2024 05:42:43 GMT -->
</html>
